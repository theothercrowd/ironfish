#!/bin/bash
echo "==================================================
############### DOWNLOADING UPDATE ###############
=================================================="
docker pull ghcr.io/iron-fish/ironfish:latest
echo "==================================================
################# STOPPING NODE ##################
=================================================="
docker stop iron_fish_node
echo "==================================================
############### REMOVING CONTAINER ###############
=================================================="
docker rm iron_fish_node
echo "==================================================
################ MIGRATIONS START ################"
=================================================="
docker run -dit --name node --restart no --network host -v $HOME/.ironfish:/root/.ironfish ghcr.io/iron-fish/ironfish:latest migrations:start
echo "==================================================
################### SLEEP NOW ####################
=================================================="
sleep 6
echo "############ RM MIGRATIONS CONTAINER #############
=================================================="
docker rm node
echo "==================================================
################## START NODE ####################
=================================================="
docker run -dit --name iron_fish_node --restart always --network host -v $HOME/.ironfish:/root/.ironfish ghcr.io/iron-fish/ironfish:latest
echo "==================================================
################## ALL DONE ######################
=================================================="
